"use strict";(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[5414],{55414:(t,e,a)=>{a.d(e,{AA:()=>p,D6:()=>h,FT:()=>I,GX:()=>_,Ir:()=>f,P_:()=>D,Rx:()=>i,TF:()=>b,WP:()=>m,Yd:()=>n,c0:()=>u,mM:()=>g,n:()=>k,zF:()=>j});var s=a(87462),o=a(35637),l=a(39492),r=function(t,e){var a=(0,s.Z)({},t),o=["projectId","milestoneId","tasklistFlag","tasklistId","taskId"];return o.splice(o.indexOf(e)+1).map((function(t){null!=a&&a[t]&&(a[t]=""),a.actions[t.split("Id")[0]]={}})),(0,s.Z)({},a)},n=function(t,e,a,o,l){var r=(0,s.Z)({},e);return r.subEvent.map((function(e){var s,n,i,d,c,u,f;(null==r||!r.projectId||null!=r&&null!=(s=r.default)&&null!=(n=s.fields)&&null!=(i=n[r.portalId])&&null!=(d=i[r.projectId])&&d[e])&&null!=r&&null!=(c=r.default)&&null!=(u=c.fields)&&null!=(f=u[r.portalId])&&f[e]?r.field_map[e]=v(r,e):_(t,r,a,o,l,e)})),(0,s.Z)({},r)},i=function(t,e,a,o,l,i,u,f,_){var k,g,I,b=(0,s.Z)({},e),v=t.target.name,j=t.target.value;if(u){var D=(0,s.Z)({},f);D[v]="",_((0,s.Z)({},D))}switch(b[v]=j,v){case"portalId":b=d(b,o,a,l,i);break;case"event":b.subEvent=[j],b.field_map={},b.actions[j]={},b=c(r(b),o,a,l,i);break;case"projectId":case"milestoneId":case"tasklistId":case"taskId":var w,Z;b=r(b,v);var y=v.split("Id")[0];b.actions[y]={},b.actions[b.event]={},b.subEvent.includes(y)&&b.subEvent.splice(b.subEvent.indexOf(y),1),["project","milestone"].includes(b.event)||"project"!==y||null!=e&&null!=(w=e.default)&&null!=(Z=w.milestones)&&Z[b.portalId]||m(o,b,a,l,i),"subtask"===b.event&&"task"!==y&&h(o,b,a,l,i),b=n(o,b,a,l,i);break;case"tasklistFlag":b.tasklistId="",j&&b.subEvent.includes("tasklist")&&b.subEvent.splice(b.subEvent.indexOf("tasklist"),1),!j||!["task","subtask"].includes(b.event)||null!=e&&null!=(k=e.default)&&null!=(g=k.milestones)&&null!=(I=g[b.portalId])&&I[j]||p(o,b,a,l,i)}a((0,s.Z)({},b))},d=function(t,e,a,o,l){var r,n,i=(0,s.Z)({},t);return i.event="",i.field_map={},i.actions={},i.subEvent=[],null==t||!t.portalId||null!=(r=t.default.tags)&&r[i.portalId]||b(e,t,a,o,l),null==t||!t.portalId||null!=(n=t.default.projects)&&n[i.portalId]||f(e,i,a,o,l),i},c=function(t,e,a,o,l){var r,n,i,d=(0,s.Z)({},t);(d.field_map={},d.field_map[d.event]=[{formField:"",zohoFormField:""}],null!=d&&d.event)&&(null!=d&&null!=(r=d.default)&&null!=(n=r.fields)&&null!=(i=n[d.portalId])&&i[d.event]?d.field_map[d.event]=v(d):_(e,d,a,o,l));return d},u=function(t,e,a,r,n){r(!0);var i={formID:t,id:e.id,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};(0,l.Z)(i,"bitforms_zprojects_refresh_portals").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);t.data.portals&&(Object.keys(t.data.portals).length>0?(l.default=(0,s.Z)({},l.default,{portals:t.data.portals}),n({show:!0,msg:(0,o.__)("Portals refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Portal Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),n({show:!0,msg:(0,o.__)("Portals refreshed","bitform")}),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Portals refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Portals refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},f=function(t,e,a,r,n){var i=e.id,d=e.portalId;r(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,l.Z)(c,"bitforms_zprojects_refresh_projects").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.default.projects||(l.default.projects={}),t.data.projects&&(Object.keys(t.data.projects).length>0?(l.default.projects[d]=t.data.projects,n({show:!0,msg:(0,o.__)("Projects refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Project Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Projects refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Projects refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},m=function(t,e,a,r,n){var i=e.id,d=e.portalId,c=e.projectId;r(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:c};(0,l.Z)(u,"bitforms_zprojects_refresh_milestones").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);t.data.milestones&&(l.default.milestones||(l.default.milestones={}),Object.keys(t.data.milestones).length>0?(l.default.milestones[c]=t.data.milestones,n({show:!0,msg:(0,o.__)("Milestones refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Milestone Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Milestones refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Milestones refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},p=function(t,e,a,r,n){var i=e.id,d=e.portalId,c=e.projectId,u=e.tasklistFlag;r(!0);var f={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:c,tasklistFlag:u};null!=e&&e.milestoneId&&(f.milestoneId=e.milestoneId),(0,l.Z)(f,"bitforms_zprojects_refresh_tasklists").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);Object.keys(t.data.tasklists).length>0?(l.default.tasklists||(l.default.tasklists={}),l.default.tasklists[d]||(l.default.tasklists[d]={}),null!=e&&e.milestoneId?(l.default.tasklists[d][e.milestoneId]||(l.default.tasklists[d][e.milestoneId]={}),l.default.tasklists[d][e.milestoneId][u]=t.data.tasklists):l.default.tasklists[d][u]=t.data.tasklists,n({show:!0,msg:(0,o.__)("Tasklists refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Tasklist Found","bitform")}),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Tasklists refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Tasklists refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},h=function(t,e,a,r,n){var i=e.id,d=e.portalId,c=e.projectId;r(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:c};null!=e&&e.milestoneId&&(u.milestoneId=e.milestoneId),null!=e&&e.tasklistId&&(u.tasklistId=e.tasklistId),(0,l.Z)(u,"bitforms_zprojects_refresh_tasks").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);Object.keys(t.data.tasks).length>0?(l.default.tasks||(l.default.tasks={}),l.default.tasks[d]||(l.default.tasks[d]={}),null!=e&&e.milestoneId?null!=e&&e.tasklistId?(l.default.tasks[d][null==e?void 0:e.milestoneId]||(l.default.tasks[d][null==e?void 0:e.milestoneId]={}),l.default.tasks[d][null==e?void 0:e.milestoneId][null==e?void 0:e.tasklistId]=t.data.tasks):l.default.tasks[d][null==e?void 0:e.milestoneId]=t.data.tasks:null!=e&&e.tasklistId?l.default.tasks[d][null==e?void 0:e.tasklistId]=t.data.tasks:l.default.tasks[d]=t.data.tasks,n({show:!0,msg:(0,o.__)("Tasks refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Task Found","bitform")}),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Tasks refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Tasks refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},_=function(t,e,a,r,n,i){var d;d=i||e.event;var c=e.portalId;r(!0);var u={formID:t,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:c,event:d};null!=e&&e.projectId&&(u.projectId=e.projectId),(0,l.Z)(u,"bitforms_zprojects_refresh_fields").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);t.data.fields?(l.default.fields||(l.default.fields={}),l.default.fields[c]||(l.default.fields[c]={}),null!=e&&e.projectId?(l.default.fields[c][e.projectId]||(l.default.fields[c][e.projectId]={}),l.default.fields[c][l.projectId][d]=(0,s.Z)({},t.data)):l.default.fields[c][d]=(0,s.Z)({},t.data),l.field_map[d]=v(l,d),n({show:!0,msg:(0,o.__)("Fields refreshed","bitform")})):n({show:!0,msg:(0,o.g)((0,o.__)("Fields refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else n({show:!0,msg:(0,o.__)("Fields refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},k=function(t,e,a,r,n){var i=e.id,d=e.portalId;r(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:e.portalId};null!=e&&e.projectId&&(c.projectId=e.projectId),(0,l.Z)(c,"bitforms_zprojects_refresh_users").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.default.users||(l.default.users={}),t.data.users&&(Object.keys(t.data.users).length>0?(null!=e&&e.projectId?(l.default.users[d]||(l.default.users[d]={}),l.default.users[d][e.projectId]=t.data.users):l.default.users[d]=t.data.users,n({show:!0,msg:(0,o.__)("Owners refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Owner Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Owners refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Owners refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},g=function(t,e,a,r,n){var i=e.id,d=e.portalId;r(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,l.Z)(c,"bitforms_zprojects_refresh_task_layouts").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.default.taskLays||(l.default.taskLays={}),t.data.taskLays&&(Object.keys(t.data.taskLays).length>0?(l.default.taskLays[d]=t.data.taskLays,n({show:!0,msg:(0,o.__)("Task Layouts refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Task Layout Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Task Layouts refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Task Layouts refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},I=function(t,e,a,r,n){var i=e.id,d=e.portalId;r(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,l.Z)(c,"bitforms_zprojects_refresh_groups").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.default.groups||(l.default.groups={}),t.data.groups&&(Object.keys(t.data.groups).length>0?(l.default.groups[d]=t.data.groups,n({show:!0,msg:(0,o.__)("Project Groups refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Project Group Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Project Groups refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Project Groups refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},b=function(t,e,a,r,n){var i=e.id,d=e.portalId;r(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,l.Z)(c,"bitforms_zprojects_refresh_tags").then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.default.tags||(l.default.tags={}),t.data.tags&&(Object.keys(t.data.tags).length>0?(l.default.tags[d]=t.data.tags,n({show:!0,msg:(0,o.__)("Tags refreshed","bitform")})):n({show:!0,msg:(0,o.__)("No Tag Found","bitform")})),t.data.tokenDetails&&(l.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},l))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,o.g)((0,o.__)("Tags refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,o.__)("Tags refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},v=function(t,e){var a,s,o;return s=e||t.event,null!=t&&t.projectId?t.default.fields[t.portalId][t.projectId][s].required.length>0?null==(o=t.default.fields[t.portalId][t.projectId][s].required)?void 0:o.map((function(t){return{formField:"",zohoFormField:t}})):[{formField:"",zohoFormField:""}]:t.default.fields[t.portalId][s].required.length>0?null==(a=t.default.fields[t.portalId][s].required)?void 0:a.map((function(t){return{formField:"",zohoFormField:t}})):[{formField:"",zohoFormField:""}]},j=function(t,e){return function(t){var e=!0;return null!=t&&t.subEvent&&t.subEvent.map((function(a){var s,o;(null!=t&&t.projectId?null!=t&&null!=(s=t.field_map)&&s[a]?t.field_map[a].filter((function(e){var s,o,l,r,n;return!e.formField&&e.zohoFormField&&-1!==(null==t||null==(s=t.default)||null==(o=s.fields)||null==(l=o[t.portalId])||null==(r=l[t.projectId])||null==(n=r[a])?void 0:n.required.indexOf(e.zohoFormField))})):[]:null!=t&&null!=(o=t.field_map)&&o[a]?t.field_map[a].filter((function(e){var s,o,l,r;return!e.formField&&e.zohoFormField&&-1!==(null==t||null==(s=t.default)||null==(o=s.fields)||null==(l=o[t.portalId])||null==(r=l[a])?void 0:r.required.indexOf(e.zohoFormField))})):[]).length>0&&(e=!1)})),!!e}(t)?function(t){var e=!0,a={project:["owner","tasklayoutid"],milestone:["owner","flag"],tasklist:["flag"],task:["owner"],subtask:["owner"],issue:["owner","flag"]};return null!=t&&t.subEvent&&t.subEvent.map((function(s){a[s].map((function(a){t.actions[s][a]||(e=!1)}))})),!!e}(t)?"subtask"!==(null==t?void 0:t.event)||null!=t&&t.taskId||t.subEvent.includes("task")?!(["task","subtask"].includes(null==t?void 0:t.event)&&(null!=t&&t.milestoneId||t.subEvent.includes("milestone"))&&!(null!=t&&t.tasklistId||t.subEvent.includes("tasklist")))||(e({show:!0,msg:(0,o.g)((0,o.__)("to create a %s under milestone you must select a tasklist or create a new tasklist","bitform"),t.event)}),!1):(e({show:!0,msg:(0,o.__)("to create a subtask you must select a task or create a new task","bitform")}),!1):(e({show:!0,msg:(0,o.__)("please fill up the required actions","bitform")}),!1):(e({show:!0,msg:(0,o.__)("please map mandatory fields","bitform")}),!1)},D=function(t,e,a,l,r,n){if(t.dataCenter&&t.clientId&&t.clientSecret){r(!0);var i="https://accounts.zoho."+t.dataCenter+"/oauth/v2/auth?scope=ZohoProjects.portals.READ,ZohoProjects.projects.READ,ZohoProjects.projects.CREATE,ZohoProjects.projects.UPDATE,ZohoProjects.milestones.READ,ZohoProjects.milestones.CREATE,ZohoProjects.milestones.UPDATE,ZohoProjects.tasklists.READ,ZohoProjects.tasklists.CREATE,ZohoProjects.tasklists.UPDATE,ZohoProjects.tasks.READ,ZohoProjects.tasks.CREATE,ZohoProjects.tasks.UPDATE,ZohoProjects.bugs.READ,ZohoProjects.bugs.CREATE,ZohoProjects.bugs.UPDATE,ZohoProjects.tags.ALL,ZohoProjects.users.READ,ZohoProjects.users.CREATE,ZohoProjects.timesheets.CREATE,ZohoPC.files.ALL&response_type=code&client_id="+t.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",d=window.open(i,"zohoProjects","width=400,height=609,toolbar=off"),c=setInterval((function(){if(d.closed){clearInterval(c);var a={},i=!1,u=localStorage.getItem("__bitforms_zohoProjects");if(u&&(i=!0,a=JSON.parse(u),localStorage.removeItem("__bitforms_zohoProjects")),a.code&&!a.error&&a&&i){var f=(0,s.Z)({},t);f.accountServer=a["accounts-server"],w(a,f,e,l,r,n)}else{var m=a.error?"Cause: "+a.error:"";n({show:!0,msg:(0,o.__)("Authorization failed","bitform")+" "+m+". "+(0,o.__)("please try again","bitform")}),r(!1)}}}),500)}else a({dataCenter:t.dataCenter?"":(0,o.__)("Data center cann't be empty","bitform"),clientId:t.clientId?"":(0,o.__)("Client ID cann't be empty","bitform"),clientSecret:t.clientSecret?"":(0,o.__)("Secret key cann't be empty","bitform")})},w=function(t,e,a,r,n,i){var d=(0,s.Z)({},t);d.dataCenter=e.dataCenter,d.clientId=e.clientId,d.clientSecret=e.clientSecret,d.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,l.Z)(d,"bitforms_zprojects_generate_token").then((function(t){return t})).then((function(t){if(t&&t.success){var l=(0,s.Z)({},e);l.tokenDetails=t.data,a(l),r(!0),i({show:!0,msg:(0,o.__)("Authorized Successfully","bitform")})}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?i({show:!0,msg:""+(0,o.__)("Authorization failed Cause:","bitform")+(t.data.data||t.data)+". "+(0,o.__)("please try again","bitform")}):i({show:!0,msg:(0,o.__)("Authorization failed. please try again","bitform")});n(!1)}))}}}]);