"use strict";(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[6195],{56195:(e,t,r)=>{r.r(t),r.d(t,{default:()=>m});var i=r(87462),a=r(67294),l=r(2804),n=r(54017),s=r(35637),o=r(75257),c=r(69151),d=r(83140),f=r(85893);function m(e){var t=e.flowID,r=e.oneDriveConf,m=e.setOneDriveConf,u=e.step,_=e.setStep,b=e.isLoading,p=e.setIsLoading,h=e.setSnackbar,v=e.redirectLocation,g=e.isInfo,I=(0,a.useState)(!1),x=I[0],D=I[1],S=(0,a.useState)({clientId:"",clientSecret:""}),y=S[0],j=S[1],k=(0,l.sJ)(n.hi),N=k.siteURL,Z=function(e){var t=(0,i.Z)({},r),a=(0,i.Z)({},y);a[e.target.name]="",t[e.target.name]=e.target.value,j(a),m(t)};return(0,f.jsxs)("div",{className:"btcd-stp-page",style:(0,i.Z)({},{width:1===u&&900},{height:1===u&&"100%"}),children:[(0,f.jsx)("div",{className:"mt-3",children:(0,f.jsx)("b",{children:(0,s.__)("Integration Name:","bitform")})}),(0,f.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:Z,name:"name",value:r.name,type:"text",placeholder:(0,s.__)("Integration Name...","bitform"),disabled:g}),(0,f.jsx)("div",{className:"mt-3",children:(0,f.jsx)("b",{children:(0,s.__)("Homepage URL:","bitform")})}),(0,f.jsx)(c.Z,{value:N,className:"field-key-cpy w-6 ml-0",readOnly:g,setSnackbar:h}),(0,f.jsx)("div",{className:"mt-3",children:(0,f.jsx)("b",{children:(0,s.__)("Authorized Redirect URIs:","bitform")})}),(0,f.jsx)(c.Z,{value:v||""+k.oneDriveRedirectURL,className:"field-key-cpy w-6 ml-0",readOnly:g}),(0,f.jsxs)("small",{className:"d-blk mt-3",children:[(0,s.__)("To Get Client Id & Secret, Please Visit","bitform")," ",(0,f.jsx)("a",{className:"btcd-link",href:"https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade",target:"_blank",rel:"noreferrer",children:(0,s.__)("Azure Portal","bitform")})]}),(0,f.jsx)("div",{className:"mt-3",children:(0,f.jsx)("b",{children:(0,s.__)("OneDrive Client Id:","bitform")})}),(0,f.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:Z,name:"clientId",value:r.clientId,type:"text",placeholder:(0,s.__)("Client Id...","bitform"),disabled:g}),(0,f.jsx)("div",{style:{color:"red"},children:y.clientId}),(0,f.jsx)("div",{className:"mt-3",children:(0,f.jsx)("b",{children:(0,s.__)("OneDrive Client Secret:","bitform")})}),(0,f.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:Z,name:"clientSecret",value:r.clientSecret,type:"text",placeholder:(0,s.__)("Client Secret...","bitform"),disabled:g}),(0,f.jsx)("div",{style:{color:"red"},children:y.clientSecret}),!g&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("button",{onClick:function(){return(0,d.P_)(r,m,D,p,j)},className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:x,children:[x?(0,s.__)("Authorized ✔","bitform"):(0,s.__)("Authorize","bitform"),b&&(0,f.jsx)(o.Z,{size:"20",clr:"#022217",className:"ml-2"})]}),(0,f.jsx)("br",{}),(0,f.jsxs)("button",{onClick:function(){(0,d.kY)(t,r,m,p,h),_(2),document.querySelector(".btcd-s-wrp").scrollTop=0},className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",disabled:!x,children:[(0,s.__)("Next","bitform"),(0,f.jsx)("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]})]})}},83140:(e,t,r)=>{r.d(t,{P_:()=>m,Rx:()=>o,e1:()=>f,kY:()=>d});var i=r(87462),a=r(80160),l=r(35637),n=r(39492),s=r(52249),o=function(e,t,r,a,l,n,s){void 0===s&&(s=0);var o=(0,i.Z)({},t),d=e.target.name;if(""!==e.target.value?o[d]=e.target.value:delete o[d],o[e.target.name]=e.target.value,"folder"===e.target.name)o.folderMap=o.folderMap.slice(0,s),o=c(o,a,r,l,n);r((0,i.Z)({},o))},c=function(e,t,r,a,l){var n,s,o=(0,i.Z)({},e);return delete o.teamType,!o.folder||null!=(n=o.default)&&null!=(s=n.folders)&&s[o.folder]?o.folder&&o.folder!==o.folderMap[o.folderMap.length-1]&&o.folderMap.push(o.folder):f(t,o,r,a,l),o},d=function(e,t,r,s,o){s(!0);var c={flowID:null!=e?e:null,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails},d=(0,n.Z)(c,"bitforms_oneDrive_get_all_folders").then((function(e){if(e&&e.success){var a=(0,i.Z)({},t);return a.default||(a.default={}),e.data.oneDriveFoldersList&&(a.default.rootFolders=e.data.oneDriveFoldersList,a.tokenDetails=e.data.tokenDetails),r(a),s(!1),"OneDrive Folders List refreshed successfully"}return s(!1),"OneDrive Folders List refresh failed. please try again"})).catch((function(){return s(!1)}));a.ZP.promise(d,{success:function(e){return e},error:(0,l.__)("Error Occurred","bitform"),loading:(0,l.__)("Loading OneDrive Folders List...","bitform")})},f=function(e,t,r,a,o,c){var d=c?t.folderMap[c]:t.folder;a(!0);var f={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,team:t.team,folder:d,teamType:"teamType"in t?"private":"team"};(0,n.Z)(f,"bitforms_oneDrive_get_single_folder").then((function(e){if(e&&e.success){var n=(0,i.Z)({},t);e.data.folders?(n.default.folders||(n.default.folders={}),n.default.folders[d]=(0,s.SI)(e.data.folders,"folderName"),n.folderMap.includes(d)||n.folderMap.push(d),o({show:!0,msg:(0,l.__)("Sub Folders refreshed","bitform")})):o({show:!0,msg:(0,l.__)("No Sub Folder Found","bitform")}),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),r((0,i.Z)({},n))}else o({show:!0,msg:(0,l.__)("Sub Folders refresh failed. please try again","bitform")});a(!1)})).catch((function(){return a(!1)}))},m=function(e,t,r,n,s){if(e.clientId&&e.clientSecret){n(!0);var o="https://login.live.com/oauth20_authorize.srf?client_id="+e.clientId+"&scope=onedrive.readwrite offline_access Files.ReadWrite.All&access_type=offline&prompt=consent&response_type=code&state="+encodeURIComponent(window.location.href)+"/redirect&redirect_uri="+encodeURIComponent(bits.oneDriveRedirectURL),c=window.open(o,"oneDrive","width=400,height=609,toolbar=off"),d=setInterval((function(){if(c.closed){clearInterval(d);var s={},o=!1,f=localStorage.getItem("__bitforms_oneDrive");if(f&&(o=!0,s=JSON.parse(f),localStorage.removeItem("__bitforms_oneDrive")),s.code&&!s.error&&s&&o){var m=(0,i.Z)({},e);m.accountServer=s["accounts-server"],u(s,m,t,r,n)}else{var _=s.error?"Cause: "+s.error:"";a.ZP.error((0,l.__)("Authorization failed","bitform")+" "+_+". "+(0,l.__)("please try again","bitform")),n(!1)}}}),500)}else s({clientId:e.clientId?"":(0,l.__)("Client Id can't be empty","bitform"),clientSecret:e.clientSecret?"":(0,l.__)("Client Secret can't be empty","bitform")})},u=function(e,t,r,s,o){var c=(0,i.Z)({},e);c.clientId=t.clientId,c.clientSecret=t.clientSecret,c.redirectURI=bits.oneDriveRedirectURL,(0,n.Z)(c,"bitforms_oneDrive_authorization").then((function(e){if(e&&e.success){var n=(0,i.Z)({},t);n.tokenDetails=e.data,r(n),s(!0),a.ZP.success((0,l.__)("Authorized Successfully","bitform"))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?a.ZP.error(""+(0,l.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,l.__)("please try again","bitform")):a.ZP.error((0,l.__)("Authorization failed. please try again","bitform"));o(!1)}))}}}]);