"use strict";(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[9293],{59293:(e,t,a)=>{a.d(t,{$8:()=>c,Ck:()=>i,P_:()=>F,Pd:()=>p,Rx:()=>o,TF:()=>m,X7:()=>f,lF:()=>h,oQ:()=>_,vF:()=>u});var l=a(87462),r=a(35637),s=a(39492),o=function(e,t,a,r,s,o,i,u,f,c){var m=(0,l.Z)({},a);if(0===t){if(u){var _=(0,l.Z)({},f);_[e.target.name]="",c((0,l.Z)({},_))}m[e.target.name]=e.target.value}else m.relatedlists||(m.relatedlists=[]),m.relatedlists[t-1][e.target.name]=e.target.value;switch(e.target.name){case"module":m=d(t,s,m,r,o,i);break;case"layout":m=n(t,s,m,r,o,i)}r((0,l.Z)({},m))},i=function(e,t,a,l,r,s,o){var i,d;e&&((null==(i=l.default)||null==(d=i.relatedlists)||!d[l.module])&&c(a,l,r,s,o));t(e)},d=function(e,t,a,r,s,o){var i,d=(0,l.Z)({},a),u=0===e?d.module:d.relatedlists[e-1].module;if(d.relatedlists[e-1]||(d.relatedlists[e-1]={}),0===e?(d.layout="",d.actions={},d.field_map=[{formField:"",zohoFormField:""}],d.upload_field_map=[{formField:"",zohoFormField:""}],d.relatedlists=[]):(d.relatedlists[e-1].layout="",d.relatedlists[e-1].actions={},d.relatedlists[e-1].field_map=[{formField:"",zohoFormField:""}],d.relatedlists[e-1].upload_field_map=[{formField:"",zohoFormField:""}]),null!=(i=d.default.layouts)&&i[u]){var c,m=Object.keys(null==(c=d.default.layouts)?void 0:c[u]);1===m.length&&(0===e?d.layout=m[0]:d.relatedlists[e-1].layout=m[0],d=n(e,t,d,r,s,o))}else f(e,t,d,r,s,o);return d},n=function(e,t,a,r,s,o){var i,d,n,u,f,c,_,h,p,F,y,b,k,v,C,D,z,Z=(0,l.Z)({},a),w=0===e?Z.module:Z.relatedlists[e-1].module,I=0===e?Z.layout:Z.relatedlists[e-1].layout;0===e?(Z.actions={},Z.field_map=null!=Z&&null!=(d=Z.default)&&null!=(n=d.layouts)&&null!=(u=n[w])&&null!=(f=u[I])&&f.required?g(e,Z):[{formField:"",zohoFormField:""}],Z.upload_field_map=null!=Z&&null!=(c=Z.default)&&null!=(_=c.layouts)&&null!=(h=_[w])&&null!=(p=h[I])&&p.requiredFileUploadFields&&Object.keys(Z.default.layouts[w][I].requiredFileUploadFields).length>0?g(e,Z,!0):[{formField:"",zohoFormField:""}]):(Z.relatedlists[e-1].actions={},Z.relatedlists[e-1].field_map=null!=Z&&null!=(F=Z.default)&&null!=(y=F.layouts)&&null!=(b=y[w])&&null!=(k=b[I])&&k.required?g(e,Z):[{formField:"",zohoFormField:""}],Z.relatedlists[e-1].upload_field_map=null!=Z&&null!=(v=Z.default)&&null!=(C=v.layouts)&&null!=(D=C[w])&&null!=(z=D[I])&&z.requiredFileUploadFields&&Object.keys(Z.default.layouts[w][I].requiredFileUploadFields).length>0?g(e,Z,!0):[{formField:"",zohoFormField:""}]);return(null==(i=Z.default.tags)||!i[w])&&m(e,t,Z,r,s,o),Z},u=function(e,t,a,o,i){o(!0);var d={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,s.Z)(d,"bitforms_zcrm_refresh_modules").then((function(e){if(e&&e.success){var s=(0,l.Z)({},t);s.default||(s.default={}),e.data.modules&&(s.default.modules=e.data.modules),e.data.tokenDetails&&(s.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},s)),i({show:!0,msg:(0,r.__)("Modules refreshed","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:(0,r.g)((0,r.__)("Modules refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):i({show:!0,msg:(0,r.__)("Modules refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))},f=function(e,t,a,o,i,d){var n=(0,l.Z)({},a),u=0===e?n.module:n.relatedlists[e-1].module;if(u){i(!0);var f={formID:t,module:u,dataCenter:n.dataCenter,clientId:n.clientId,clientSecret:n.clientSecret,tokenDetails:n.tokenDetails};(0,s.Z)(f,"bitforms_zcrm_refresh_layouts").then((function(a){var s;if(a&&a.success){if(a.data.layouts){n.default.layouts||(n.default.layouts={}),n.default.layouts[u]=a.data.layouts;var f,c=[].concat(Object.keys(a.data.layouts));if(1===c.length)0===e?(n.layout=c[0],n.field_map=g(e,n),Object.keys(a.data.layouts[c].fileUploadFields).length>0&&(n.upload_field_map=g(e,n,!0))):(n.relatedlists[e-1].layout=c[0],n.relatedlists[e-1].field_map=g(e,n),Object.keys(a.data.layouts[c].fileUploadFields).length>0&&(n.relatedlists[e-1].upload_field_map=g(e,n,!0))),null!=(f=n.default.tags)&&f[u]||m(e,t,n,o,i,d)}a.data.tokenDetails&&(n.tokenDetails=a.data.tokenDetails),o((0,l.Z)({},n)),d({show:!0,msg:(0,r.__)("Layouts refreshed","bitform")})}else null!=a&&null!=(s=a.data)&&s.data||!a.success&&"string"===typeof a.data?d({show:!0,msg:(0,r.g)((0,r.__)("Layouts refresh failed Cause: %s. please try again","bitform"),a.data.data||a.data)}):d({show:!0,msg:(0,r.__)("Layouts refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},c=function(e,t,a,o,i){if(t.module){o(!0);var d={formID:e,module:t.module,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,s.Z)(d,"bitforms_zcrm_get_related_lists").then((function(e){var s;if(e&&e.success){var d=(0,l.Z)({},t);e.data.relatedLists&&(d.default.relatedlists||(d.default.relatedlists={}),d.default.relatedlists[d.module]=(0,l.Z)({},e.data.relatedLists)),e.data.tokenDetails&&(d.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},d)),i({show:!0,msg:(0,r.__)("RelatedLists refreshed","bitform")})}else null!=e&&null!=(s=e.data)&&s.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:""+(0,r.__)("RelatedLists refresh failed Cause:")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):i({show:!0,msg:(0,r.__)("RelatedLists refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}},m=function(e,t,a,o,i,d){var n=0===e?a.module:a.relatedlists[e-1].module;if(n){i(!0);var u={formID:t,module:n,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};(0,s.Z)(u,"bitforms_zcrm_get_tags").then((function(e){var t;if(null!=e&&e.success){var s=(0,l.Z)({},a);e.data.tags&&(s.default.tags||(s.default.tags={}),s.default.tags[n]=(0,l.Z)({},e.data.tags)),e.data.tokenDetails&&(s.tokenDetails=e.data.tokenDetails),o((0,l.Z)({},s)),d({show:!0,msg:(0,r.__)("Tags refreshed","bitform")})}else null!=e&&null!=(t=e.data)&&t.data||!e.success&&"string"===typeof e.data?d({show:!0,msg:""+(0,r.__)("Tags refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):d({show:!0,msg:(0,r.__)("Tags refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},_=function(e,t,a,o,i){o(!0);var d={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,s.Z)(d,"bitforms_zcrm_get_users").then((function(e){if(null!=e&&e.success){var s=(0,l.Z)({},t);s.default.crmOwner=e.data.users,e.data.tokenDetails&&(s.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},s)),i({show:!0,msg:(0,r.__)("Owners refreshed","bitform")})}else i({show:!0,msg:(0,r.__)("Owners refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))},h=function(e,t,a,o,i){var d=0===e?t.module:t.relatedlists[e-1].module;if(d){o(!0);var n={module:d,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,s.Z)(n,"bitforms_zcrm_get_assignment_rules").then((function(e){if(null!=e&&e.success){var s=(0,l.Z)({},t);s.default.assignmentRules||(s.default.assignmentRules={}),e.data.tokenDetails&&(s.tokenDetails=e.data.tokenDetails),s.default.assignmentRules[d]=(0,l.Z)({},e.data.assignmentRules),a((0,l.Z)({},s)),i({show:!0,msg:(0,r.__)("Assignment Rules refreshed","bitform")})}else i({show:!0,msg:(0,r.__)("Assignment Rules refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}},g=function(e,t,a){var l=0===e?t.module:t.relatedlists[e-1].module,r=0===e?t.layout:t.relatedlists[e-1].layout;return a?t.default.layouts[l][r].requiredFileUploadFields.length>0?t.default.layouts[l][r].requiredFileUploadFields.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]:t.default.layouts[l][r].required.length>0?t.default.layouts[l][r].required.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]},p=function(e){var t=null!=e&&e.field_map?e.field_map.filter((function(t){var a,l,r,s;return!t.formField&&t.zohoFormField&&-1!==(null==e||null==(a=e.default)||null==(l=a.layouts)||null==(r=l[e.module])||null==(s=r[e.layout])?void 0:s.required.indexOf(t.zohoFormField))})):[],a=null!=e&&e.upload_field_map?e.upload_field_map.filter((function(t){return!t.formField&&t.zohoFormField&&-1!==e.default.layouts[e.module][e.layout].requiredFileUploadFields.indexOf(t.zohoFormField)})):[],l=e.relatedlists.map((function(e){return e.field_map.filter((function(e){return!e.formField&&e.zohoFormField}))})),r=e.relatedlists.map((function(e){return e.upload_field_map.filter((function(e){return!e.formField&&e.zohoFormField}))}));return!(t.length>0||a.length>0||l.some((function(e){return e.length}))||r.some((function(e){return e.length})))},F=function(e,t,a,s,o,i){if(e.dataCenter&&e.clientId&&e.clientSecret){o(!0);var d="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=ZohoCRM.modules.ALL,ZohoCRM.settings.ALL,ZohoCRM.users.Read,zohocrm.files.CREATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",n=window.open(d,"zohoCRM","width=400,height=609,toolbar=off"),u=setInterval((function(){if(n.closed){clearInterval(u);var a={},d=!1,f=localStorage.getItem("__bitforms_zohoCRM");if(f&&(d=!0,a=JSON.parse(f),localStorage.removeItem("__bitforms_zohoCRM")),a.code&&!a.error&&a&&d){var c=(0,l.Z)({},e);c.accountServer=a["accounts-server"],y(a,c,t,s,o,i)}else{var m=a.error?"Cause: "+a.error:"";i({show:!0,msg:(0,r.__)("Authorization failed","bitform")+" "+m+". "+(0,r.__)("please try again","bitform")}),o(!1)}}}),500)}else a({dataCenter:e.dataCenter?"":(0,r.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,r.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,r.__)("Secret key cann't be empty","bitform")})},y=function(e,t,a,o,i,d){var n=(0,l.Z)({},e);n.dataCenter=t.dataCenter,n.clientId=t.clientId,n.clientSecret=t.clientSecret,n.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,s.Z)(n,"bitforms_zcrm_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var s=(0,l.Z)({},t);s.tokenDetails=e.data,a(s),o(!0),d({show:!0,msg:(0,r.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?d({show:!0,msg:""+(0,r.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):d({show:!0,msg:(0,r.__)("Authorization failed. please try again","bitform")});i(!1)}))}}}]);